<!-- Live chat -->
<div id="chat-wrapper" 
     class="position-fixed bottom-0 end-0 d-flex flex-row gap-2 p-3 align-items-end" 
     style="z-index:999; display:none;">

  <!-- Liste des utilisateurs connectés -->
  <div id="user-list-container" 
       class="card shadow-sm">
    <div class="card-header bg-light d-flex justify-content-between align-items-center">
      <h6 class="mb-0">Utilisateurs connectés</h6>
      <button id="user-list-toggle" class="btn btn-sm btn-light">Réduire</button>
    </div>
    <div class="card-body p-3 overflow-y: auto;">

      <h6 class="mb-2">Amis connectés</h6>
      <ul id="friends-connected" class="list-group mb-3"></ul>

      <h6 class="mb-2">Autres connectés</h6>
      <ul id="others-connected" class="list-group"></ul> <!-- <ul> permet de créer une list unordered (insèrer dynamiquement les <li>)-->
    </div> <!-- <li> dans le script représente chq élément de la liste + own info -->
  </div>

  <!-- Fenêtre de chat -->
  <div id="chat-container" 
       class="card shadow-lg">

    <div class="card-header d-flex justify-content-between align-items-center bg-primary text-white">
      <h5 class="mb-0">Live Chat</h5>
      <button id="chat-toggle" class="btn btn-sm btn-light">Réduire</button>
    </div>
    
    <div id="message-area" class="card-body p-3 overflow-auto">
      <div id="message-list"></div>
    </div>

    <div class="card-footer">
        <div class="input-group mb-2">
            <input type="text" id="message-input" class="form-control" placeholder="Entrez votre message...">
            <button id="send-message-btn" class="btn btn-primary">Envoyer</button>
        </div>
        <div class="input-group">
            <select id="private-recipient" class="form-select">
                <option value="" disabled selected>Choisir un destinataire</option>
            </select>
            <button id="send-private-btn" class="btn btn-secondary">Envoyer privé</button>
            <button id="invite-to-game-btn" class="btn btn-warning">Inviter au Pong</button>
        </div>
    </div>
  </div>
</div>

<style>

/* Styles "par défaut" (Desktop first) > Check si conflict with Boostrap ?*/
#user-list-container {
  width: 240px;
  height: 450px;
  overflow:hidden;
  position: relative;
  /* z-index: 1050; */
  transition: transform 0.3s ease-in-out; /* Animation when change its state */
  transform: translateY(0);
}

#user-list-container .card-body {
  max-height: 350px;
  overflow-y: auto;
}

#chat-container {
  width: 450px;
  height: 450px;
  overflow: hidden;
  transition: transform 0.3s ease-in-out;
  transform: translateY(0); /* État "ouvert" */
}

#chat-container.collapsed {
    transform: translateY(420px); /* Fais glisser le chat vers le bas + header visible */
}

#user-list-container.collapsed {
  transform: translateY(420px);
}

/* Hide only footer + messages */
#chat-container.collapsed #message-area,
#chat-container.collapsed .card-footer {
    display: none;
}

#user-list-container.collapsed #user-list {
  display: none;
}

#user-list-container, #chat-container {
  max-width: 70vw;
  max-height: 80vh;
}

/* < 1200px */
   @media (max-width: 1200px) {
  #user-list-container {
    width: 210px;
    height: 400px;
  }
  #chat-container {
    width: 380px;
    height: 400px;
  }
  #chat-container.collapsed {
    transform: translateY(370px);
  }
  #user-list-container.collapsed {
    transform: translateY(370px);
  }
}

/* < 992px */
@media (max-width: 992px) {
  #user-list-container {
    width: 180px;
    height: 350px;
  }
  #chat-container {
    width: 320px;
    height: 350px;
  }
  #chat-container.collapsed {
    transform: translateY(320px);
  }
  #user-list-container.collapsed {
    transform: translateY(320px);
  }
}

/* < 768px */
@media (max-width: 768px) {
  #user-list-container {
    width: 160px;
    height: 300px;
  }
  #chat-container {
    width: 280px;
    height: 300px;
  }
  #chat-container.collapsed {
    transform: translateY(270px);
  }
  #user-list-container.collapsed {
    transform: translateY(270px);
  }
}

/* < 576px */
@media (max-width: 576px) {
  #user-list-container {
    width: 130px;
    height: 250px;
  }
  #chat-container {
    width: 230px;
    height: 250px;
  }
  #chat-container.collapsed {
    transform: translateY(220px);
  }
  #user-list-container.collapsed {
    transform: translateY(220px);
  }
}

#message-area {
    background-color: #f8f9fa;
    border-top: 1px solid #ddd;
}
.message {
    margin-bottom: 10px;
    padding: 5px;
    border-radius: 5px;
}
.message .username {
    font-weight: bold;
}
.message.system {
    color: #999;
    font-style: italic;
}


.error-message {
    color: red;
    font-weight: bold;
    padding: 5px;
    border: 1px solid red;
    background-color: #ffe6e6;
    border-radius: 4px;
    margin-bottom: 5px;
}

.custom-padding {
    padding: 12px 20px;
    margin: 5px;
}

</style>